<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"  
      xmlns:f="http://java.sun.com/jsf/core"  
      xmlns:p="http://primefaces.org/ui">

    <h:body>  
        <ui:composition template="./../template.xhtml">
            <ui:define name="content">
                 <p:growl id="msgs" showDetail="true" /> 
                 <h:form style="margin-top: 15px;margin-bottom: 10px;">
                    <p:commandButton id="btnForoCreate" update=":formCreate" oncomplete="PF('dialogForoCreate').show()" icon="icon-new" title="Crear" value="Crear"/>                      
                </h:form>
                  <h:form id="formDataTablePost">
                      <p:dataTable id="posts" var="post" value="#{postBean.posts}"
                     paginator="true" rows="5" paginatorPosition="bottom" 
                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" 
                     style="border: 1px solid #848484; margin-top: 3%; margin-bottom: 2%"
                     >
                      
                          <p:column headerText="Lista de Foros" >
                             
                              <p:panel id="basic" header="#{post.titulo}" footer="Escrito por: #{post.usuario.usuario} el #{post.dia} de #{post.mes} de #{post.anio} a las #{post.hora}" style="margin-bottom:20px; margin-top: 20px; border: 1px solid #848484;font-family: sans-serif" >                                  
                                  <h:outputText 
                                      value=" #{post.contenido} " />
                                  <br/>
                                  <div align="right">
                                      <p:commandButton  actionListener="#{postBean.seguirPost(event)}"
                                                        oncomplete="handlePostRequest(xhr, status, args)" value="Ver" style="width: 70; height: 30px" >
                                          
                                          <f:setPropertyActionListener value="#{post}" target="#{postBean.selectedPost}" />
                                      </p:commandButton>
                                  </div>
                              </p:panel>
                              <p:separator style="width:100%;height:2px;background:#000000;border: 0.5px solid #000000" />
                          </p:column>
                  </p:dataTable>
              </h:form>
                 <h:form id="formCreate">
                     <p:dialog header="Crear Entrada a Foro" widgetVar="dialogForoCreate" id="dlgForoCreate"  showEffect="fade" hideEffect="explode" resizable="false" modal="true">
                         <h:panelGrid  id="display" columns="2" cellpadding="4" style="margin:0 auto;">

                             <h:outputText value="Titulo Post: " />
                             <p:inputText value="#{postBean.selectedPost.titulo}"/>

                             <h:outputText value="Contenido: " />
                             <p:inputTextarea id="txtContenido" rows="5" cols="50" counter="display1" maxlength="250" counterTemplate="{0} caracteres restantes." autoResize="true" value="#{postBean.selectedPost.contenido}" />
                             <h:outputText id="display1"/>      
                             <f:facet name="footer">
                                 <p:separator/>
                                 <p:commandButton id="btnCreateAceptar" update=":formDataTablePost, :msgs" oncomplete="PF('dialogForoCreate').hide()" actionListener="#{postBean.btnCreateForo(actionEvent)}" icon="ui-icon-check" title="Guardar" value="Crear"/>
                                 <p:commandButton id="btnCreateCancelar" oncomplete="PF('dialogForoCreate').hide()" icon="ui-icon-close" title="Cancelar" value="Cancelar"/>
                             </f:facet>
                         </h:panelGrid>
                     </p:dialog>
                 </h:form>
            </ui:define>
        </ui:composition>        
    </h:body>  
</html>
